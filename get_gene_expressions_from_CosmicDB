
cores=$1

COSMIC_PASS=`cat $WORKDIR/COSMIC_password` ; export COSMIC_PASS
COSMICDB_USER=`cat $WORKDIR/COSMIC_email` ; export COSMICDB_USER

> $WORKDIR/receptors_contracted.tmp
#rm -f ./genes/expressions/* ./genes/expression_scores.csv ./genes/Uniprot_ID_list


cancer_type=`cat $WORKDIR/cancer_type`
grep $cancer_type cross_references > $WORKDIR/tmp
tissue=`cat $WORKDIR/tmp | awk '{print $2}'`
rm $WORKDIR/tmp 

eval "$(/home/namd5/vini_3_1/miniconda3/bin/conda shell.bash hook)"
conda activate Vini
gene_index=1
while read -r line
do
    Uniprot_ID=`echo $line | awk '{print $3}'`
    echo "trying to obtain from CosmicDB gene expression for KEGG entry " $gene_index "UniprotID:" $Uniprot_ID
    python get_gene_expression_parallel.py -g $Uniprot_ID -t $tissue -n $cores
    let "gene_index++" 
done < $WORKDIR/receptors_contracted
conda deactivate
