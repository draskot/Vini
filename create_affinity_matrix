

nr_ligands=`wc -l < ligands_list`
nr_complexes=`wc -l < receptors_contracted`
target_dir=`cat target_dir`

for i in nr_complexes                   #outer loop for matrix row
do
    lineno=1
    for j in nr_ligands                 #inner loop for matrix column
    do
        affine=`head -n "$lineno" "$target_dir/vec" | tail -n 1`
        printf "%s" "$affine" >> $target_dir/affinity_matrix
        printf "%s" " " >> $target_dir/affinity_matrix
        let "lineno++"
    done
    printf '%s\n' >> $target_dir/affinity_matrix
done

