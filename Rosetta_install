grep Rosetta $vini_dir/sourceme > tmp
if  [ ! -s tmp ]
then
    module avail Rosetta 2> tmp
    grep Rosetta tmp > rosetta
    if [ -s rosetta ]
    then
        echo "Found the following module(s) that may be associated with Rosetta:" ; cat rosetta
    fi
    read -p "Write the Rosetta module name or q to quit:" rosetta
    if  [ $rosetta != q ] ; then
        module avail 2> tmp
        grep "$rosetta" tmp > tmp2
        if [ -s tmp2 ] ; then
            echo "#*****Rosetta section******" >> $vini_dir/sourceme
            echo "module load" $rosetta >> $vini_dir/sourceme
            module load $rosetta
            which docking_protocol.linuxgccrelease > tmp          #defining ROSETTA var
            var=`cat tmp`                                         
            var2=${var::-48}
            echo "export ROSETTA=$var2" >> $vini_dir/sourceme
            command -v docking_protocol.mpi.linuxgccrelease > tmp #checking for MPI support
            if  [ -s tmp ] ; then
                echo "mpi" > $WORKDIR/rosie
            else
                echo "static" > $WORKDIR/rosie
            fi
        else
            echo "module" $rosetta "does not exist."
            echo "Rosetta is used for the analysis of mAb drugs and can be installed later."
            echo "However, to activate Rosetta you must restart this install.sh script."
            read -p "Press <enter> to continue." anykey
        fi
    else
        echo "Rosetta is used for the analysis of mAb drugs and can be installed later."
        echo "However, to activate Rosetta you must restart this install.sh script."
        read -p "Press <enter> to continue." anykey
    fi
fi
rm -f rosetta tmp tmp2
