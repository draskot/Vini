#chebi_id=`curl -s http://rest.kegg.jp/conv/chebi/$KEGG_gene_name | python -mhtmllib - | awk '{print $2}'`

#input parameter: Pubchem ID
#output parameter: substance structure file in DOWNLOAD_DIR

pubchem_id=$1
DOWNLOAD_DIR=$2

ONES=1

pubchem_id=`echo ${pubchem_id} | tr -dc '[0-9\n]'`

prefix="https://pubchem.ncbi.nlm.nih.gov/rest/pug/substance/SID/"
suffix="/record/SDF/?deposited=t&version=12&response_type=save&response_basename=Structure2D_SID_"

wget -O ${pubchem_id} $prefix${pubchem_id}$suffix${pubchem_id}

obabel -isdf ${pubchem_id} -O tmp.pdb -h 2> $WORKDIR/stats
mv tmp.pdb $DOWNLOAD_DIR/pubchem:${pubchem_id}.pdb

warning=`grep "Alias R was not chemically interpreted" $WORKDIR/stats`   #check for bable error
echo $warning > $WORKDIR/tmp
chars=`wc -c < $WORKDIR/tmp`
if  [ $chars -gt $ONES ]
then
    echo "fail"
    rm $DOWNLOAD_DIR/pubchem:${pubchem_id}.pdb
fi
