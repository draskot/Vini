

cluster=`uname -n`
echo "Available job queues on" $cluster "are:"
qstat -q
read -p "press enter to continue:" enter

read -p  "enter the name of cluster partition Autodock Vina will use:" Vina
read -p  "enter the name of cluster partition Gromacs (MD_prepare) will use:" MD_prepare
read -p  "enter the name of cluster partition Gromacs (MD_run) will use:" MD_run
read -p  "enter the name of cluster partition Gromacs (create_index_file) will use:" ndx
read -p  "enter the name of cluster partition g_mmpbsa (potential) will use:" potential
read -p  "enter the name of cluster partition g_mmpbsa (polar) will use:" polar
read -p  "enter the name of cluster partition g_mmpbsa (apolar) will use:" apolar
read -p  "enter the name of cluster partition g_mmpbsa (compute_FBE) will use:" FBE

echo "#! /bin/bash"               > $WORKDIR/Vina #prepare Vina header file
echo "#PBS -N Vina"              >> $WORKDIR/Vina
echo "#PBS -o Vina.out"        >> $WORKDIR/Vina
echo "#PBS -e Vina.out"        >> $WORKDIR/Vina
echo "#PBS -l walltime=00:30:00" >> $WORKDIR/Vina
echo "#PBS -l nodes=1:ppn=3"     >> $WORKDIR/Vina
echo "#PBS -l mem=8gb"           >> $WORKDIR/Vina
echo "#PBS -q " $Vina            >> $WORKDIR/Vina

echo "#! /bin/bash"                            > tmp  #prepare Gromacs header files
echo "#PBS -N MD_prepare"                     >> tmp
echo "#PBS -o MD_prepare.out"                 >> tmp
echo "#PBS -e MD_prepare.out"                 >> tmp
echo "#PBS -l walltime=01:00:00"              >> tmp
echo "#PBS -l nodes=1:ppn=1"                  >> tmp         
echo "#PBS -l mem=4gb"                        >> tmp
echo "#PBS -q " $MD_prepare                   >> tmp
cat tmp > MD_prepare
chmod u+x MD_prepare
cat MD_prepare_script >> MD_prepare

echo "#! /bin/bash"                            > tmp
echo "#PBS -N MD_run"                         >> tmp
echo "#PBS -o MD_run.out"                     >> tmp
echo "#PBS -e MD_run.out"                     >> tmp
echo "#PBS -l walltime=12:00:00"               >> tmp
echo "#PBS -l nodes=1:ppn=4"                  >> tmp         
echo "#PBS -l mem=32gb"                       >> tmp
echo "#PBS -q " $MD_run                       >> tmp
cat tmp > MD_run
chmod u+x MD_run
cat MD_run_script >> MD_run

echo "#! /bin/bash"                            > tmp
echo "#PBS -N ndx"                            >> tmp
echo "#PBS -o ndx.out"                        >> tmp
echo "#PBS -e ndx.out"                        >> tmp
echo "#PBS -l walltime=12:10:00"               >> tmp
echo "#PBS -l nodes=1:ppn=1"                  >> tmp         
echo "#PBS -l mem=4gb"                        >> tmp
echo "#PBS -q " $ndx                          >> tmp
cat tmp > create_index_file
chmod u+x create_index_file
cat create_index_file_script >> create_index_file

echo "#! /bin/bash"                            > tmp  #prepare mmpbsa header files
echo "#PBS -N potential"                      >> tmp
echo "#PBS -o potential.out"                  >> tmp
echo "#PBS -e potential.out"                  >> tmp
echo "#PBS -l walltime=24:00:00"               >> tmp
echo "#PBS -l nodes=1:ppn=16"                 >> tmp         
echo "#PBS -l mem=16gb"                       >> tmp
echo "#PBS -q " $potential                    >> tmp
echo "export OMP_NUM_THREADS=16"              >> tmp
echo "export APBS=/scratch/opt2/apbs-1.3/bin/apbs" >> tmp
cat tmp > g_mmpbsa_potential_energy
chmod u+x g_mmpbsa_potential_energy
cat g_mmpbsa_potential_energy_script >> g_mmpbsa_potential_energy

echo "#! /bin/bash"                            > tmp
echo "#PBS -N apolar"                         >> tmp
echo "#PBS -o apolar.out"                     >> tmp
echo "#PBS -e apolar.out"                     >> tmp
echo "#PBS -l walltime=24:00:00"               >> tmp
echo "#PBS -l nodes=1:ppn=4"                  >> tmp         
echo "#PBS -l mem=8gb"                        >> tmp
echo "#PBS -q " $apolar                       >> tmp
echo "export OMP_NUM_THREADS=4"              >> tmp
echo "export APBS=/scratch/opt2/apbs-1.3/bin/apbs" >> tmp
cat tmp > g_mmpbsa_apolar_energy
chmod u+x g_mmpbsa_apolar_energy
cat g_mmpbsa_apolar_energy_script >> g_mmpbsa_apolar_energy

echo "#! /bin/bash"                            > tmp
echo "#PBS -N polar"                          >> tmp
echo "#PBS -o polar.out"                      >> tmp
echo "#PBS -e polar.out"                      >> tmp
echo "#PBS -l walltime=24:00:00"              >> tmp
echo "#SBATCH --nodes=1"                      >> tmp
echo "#PBS -l nodes=1:ppn=16"                 >> tmp         
echo "#PBS -l mem=24gb"                       >> tmp
echo "#PBS -q " $MD_prepare                   >> tmp
echo "export OMP_NUM_THREADS=16"              >> tmp
echo "export APBS=/scratch/opt2/apbs-1.3/bin/apbs" >> tmp
cat tmp > g_mmpbsa_polar_energy
chmod u+x g_mmpbsa_polar_energy
cat g_mmpbsa_polar_energy_script >> g_mmpbsa_polar_energy

echo "#! /bin/bash"                            > tmp
echo "#PBS -N FBE_calc"                       >> tmp
echo "#PBS -o FBE_calc.out"                   >> tmp
echo "#PBS -e FBE_calc.out"                   >> tmp
echo "#PBS -l walltime=24:00:00"               >> tmp
echo "#PBS -l nodes=1:ppn=1"                  >> tmp         
echo "#PBS -l mem=4gb"                        >> tmp
echo "#PBS -q " $FBE                          >> tmp
echo "export OMP_NUM_THREADS=1"               >> tmp
cat tmp > compute_FBE
chmod u+x compute_FBE
cat compute_FBE_script >> compute_FBE
