NULL=0
ONES=1
ORGANISM=`cat $WORKDIR/ORGANISM`                    #getting the organism type from the main script
cancer_type=`cat $WORKDIR/cancer_type`              #getting the cancer type from the main script
CANCER_PATHWAY=$ORGANISM$cancer_type                #setting the cancer pathway
therapy_level=`cat $WORKDIR/therapy_level`         #therapy level
compute_cell_line=`cat $WORKDIR/compute_cell_line`
cosmic=`cat $WORKDIR/cosmic`
cell_line=`cat $WORKDIR/cell_line`                  #getting the cell line name
job_status=`cat job_status`       
job_submit=`cat job_submit`
exhaustiveness=`cat $WORKDIR/exhaustiveness`
box_size=`cat $WORKDIR/box_size`
random_affinity=`cat $WORKDIR/random_affinity`
max_jobs=`cat $WORKDIR/max_jobs` #maximum number of Vina jobs
MAX_NODES=`cat $WORKDIR/nodes`       #maximum number of compute nodes Vini can use concurrently
partition=`cat $WORKDIR/cpu_partition`
walltime=`sinfo | grep $partition | head -1 | awk '{print $3}'` #By default we are running Vini jobs on cpu nodes
excluded_nodes=`cat $WORKDIR/excluded_${partition}_nodes`
complexes=`wc -l < $WORKDIR/receptors_contracted`
ligands=`wc -l < $vini_dir/ligands/ligands_list`
lig_source=$WORKDIR/ligands

mkdir -p $WORKDIR/${CANCER_PATHWAY}_results #Create directory for results
cd $WORKDIR

L1=1; L2=1; L3=1; L4=1;                 #Initializing main loops
case $therapy_level in                  
     1) L4=$ligands ;;
     2) L3=$ligands; L4=$ligands ;;
     3) L2=$ligands; L3=$ligands; L4=$ligands ;;
     4) L1=$ligands; L2=$ligands; L3=$ligands; L4=$ligands ;;
esac

state=`cat $WORKDIR/state`                 #setting loop control parameters
dir=$WORKDIR/${cancer_type}_data 
if  [ $state == crash ]
then
    ligand_number=`grep ligand_number $WORKDIR/restartfile | awk '{print $2}'`
    Kappa=`grep          I         $WORKDIR/restartfile | awk '{print $2}'`
    Lambda=`grep         J         $WORKDIR/restartfile | awk '{print $2}'`
    Mu=`grep             L         $WORKDIR/restartfile | awk '{print $2}'`
    Nu=`grep             M         $WORKDIR/restartfile | awk '{print $2}'`
    Xi=$ONES
    echo "deleting SLEM values after the last checkpoint"
    MaxSLEMvalues=`echo ${Kappa} ${Lambda} ${Mu} ${Nu} ${Xi} ${ligands} | awk '{print $1 * $2 * $3 * $4 * $5 * $6 }'`
    NoSLEMvalues=`echo ${Kappa} ${Lambda} ${Mu} ${Nu} ${Xi} ${ligand_number} | awk '{print $1 * $2 * $3 * $4 * $5 * $6 }'`
    Delete=`echo $MaxSLEMvalues $NoSLEMvalues $ONES | awk '{print $1 - $2 - $3}'`
    head -$Delete $vini_dir/ligands/ligands_list > $WORKDIR/tmp
    mv $WORKDIR/tmp $WORKDIR/SLEM_values
else
    ligand_number=1                #initializing ligand index
    Kappa=$ONES
    Lambda=$ONES
    Mu=$ONES
    Nu=$ONES
    Xi=$ONES
    > $WORKDIR/SLEM_values    #delete SLEM values from the previous run
fi
 
SECONDS=$NULL

echo "Calculating free binding energies for therapy level ${therapy_level}. This may take a while, please be patient."

for (( I=$((Kappa)); I<$((L1+1)); I++ )) #1st loop - 4th therapy level
do
    for (( J=$((Lambda)); J<$((L2+1)); J++ )) #2nd loop -3rd therapy level
    do
         for (( L=$((Mu)); L<$((L3+1)); L++ )) #3rd loop -2nd thl
         do
             for (( M=$((Nu)); M<$((L4+1)); M++ )) #4th loop - 1st thl
             do
                 printf -v lig_index "%03d" $M  
                 case $therapy_level in
                     1) comp_source=$dir;          target_dir=$dir/$M ;;
                     2) comp_source=$dir/$M;       target_dir=$dir/$M/$L ;;
                     3) comp_source=$dir/$M/$L;    target_dir=$dir/$M/$L/$J ;;
                     4) comp_source=$dir/$M/$L/$J; target_dir=$dir/$M/$L/$J/$I ;;
                 esac
                 mkdir -p $comp_source $target_dir # nr. of target dirs equals nr. of ligands
                 for (( N=$((Xi)); N<$((complexes+1)); N++ )) #5th loop
       	         do
                     printf -v n "%03d" $N
                     comp_index=$n
                     conf_index=$comp_index
                     log_index=$comp_index
                     line=`head -"$ligand_number" $vini_dir/ligands/ligands_list | tail -1`
                     drug=`echo $line | awk -F',' '{print $1}'`
                     moltype=`echo $line | awk -F','  '{print $2}'`
                     mkdir -p $WORKDIR/$comp_index
                     cd $WORKDIR/$comp_index   #move to the working area
                     rm -rf *
                     if [ $moltype == S ] #if a small molecule, we are running Vina, else Rosetta docking
                     then
                         cp $MGLTOOLS/AD4_parameters.dat ./                     
                         if  [ ! -e ${comp_source}/complex_${comp_index}.pdbqt ] #get receptor pdbqt file
                         then
                             $MGLBIN/pythonsh $MGLUTILS/prepare_receptor4.py -r $comp_source/complex_$comp_index.pdb -o $comp_source/complex_${comp_index}.pdbqt
                         else
                             cp ${comp_source}/complex_${comp_index}.pdbqt ./
                         fi

                         if [ -e $WORKDIR/ligands/ligand_${lig_index}.pdbqt ]    #get ligand pdbqt file
                         then
                             cp $WORKDIR/ligands/ligand_${lig_index}.pdbqt ./
                         else
                             cp $vini_dir/ligands/pdb_files/"${drug}".pdb ./
                             ls "${drug}".pdb > tmp
                             nowords=`wc -w < tmp`
                             if [ $nowords -eq $ONES ]
                             then
                                 $MGLBIN/pythonsh $MGLTOOLS/Utilities24/prepare_ligand4.py -l "${drug}".pdb -o $WORKDIR/ligands/ligand_${lig_index}.pdbqt
                             else
                                 mv "${drug}".pdb tmp.pdb        #python does not work with 2-name drug
                                 $MGLBIN/pythonsh $MGLTOOLS/Utilities24/prepare_ligand4.py -l tmp.pdb -o tmp.pdbqt
                                 mv tmp.pdbqt  $WORKDIR/ligands/ligand_${lig_index}.pdbqt
                             fi
                         fi
                         $MGLBIN/pythonsh $MGLUTILS/prepare_gpf.py -l ligand_${lig_index}.pdbqt -r complex_${comp_index}.pdbqt
                         sh $vini_dir/create_Vina_config_file ${lig_index} ${comp_index} ${conf_index} ${comp_source}
                             echo "#!/bin/bash"                                        > dock
                             echo "#SBATCH --time="$walltime                          >> dock
                             echo "#SBATCH --account=$SLURMACCT"                      >> dock
                             echo "#SBATCH --partition="$partition                    >> dock
                             echo "#SBATCH --nodes=1"                                 >> dock
                             echo "#SBATCH --ntasks=1"                                >> dock
                             echo "#SBATCH --cpus-per-task=48"                        >> dock
                             echo "#SBATCH --job-name=Vina_${M}_${N}"                 >> dock
                             echo "#SBATCH --output=${target_dir}/Vina_${M}_${N}.out" >> dock
                             echo "#SBATCH --exclude=${excluded_nodes}"               >> dock 
                             echo "vina --cpu 48 --size_x 40 --size_y 40 --size_z 40 --config $comp_source/conf_$conf_index.txt --exhaustiveness ${exhaustiveness} --receptor $comp_source/complex_${comp_index}.pdbqt --ligand ligand_${lig_index}.pdbqt --out $target_dir/complex_${comp_index}.pdbqt > $target_dir/log_$log_index.txt"                   >> dock
                             #cat $vini_dir/log_Vina_IC_value                         >> dock
                             chmod u+x dock
                             sh $vini_dir/jobs_control_script ${job_status} ${max_jobs}
                             ${job_submit} dock
                     else                                                                     
                         if [ ! -e $comp_source/complex_${comp_index}.pdb ]    #Rosetta docking
                         then
                             obabel $comp_source/complex_${comp_index}.pdbqt -O complex_${comp_index}.pdb
                         else
                             #cp $comp_source/complex_${comp_index}.pdb ./      #debug only!!!!!!!!!
                             cp $vini_dir/1AKI.pdb ./complex_${comp_index}.pdb 
                         fi
                         #cp $WORKDIR/ligands/ligand_${lig_index}.pdb ./        #debug only !!!!!!!!!
                         cp $vini_dir/ligands/pdb_files/Bevacizumab.pdb ./ligand_${lig_index}.pdb

                         sh $vini_dir/jobs_control_script ${job_status} ${max_jobs}
                         cp $vini_dir/flag_input_relax $vini_dir/flag_global_docking $vini_dir/docking.mac ./
                         
                         cp complex_${comp_index}.pdb receptor.pdb     #generate complex with Hex
                         cp ligand_${lig_index}.pdb ligand.pdb
                         hex -batch receptor.pdb ligand.pdb < docking.mac > docking.log 
                         cp complex.pdb complex_${comp_index}.pdb
                         rm receptor.pdb ligand.pdb docking.log docking.mac ligand_${lig_index}.pdb

                         python ${ROSETTA_TOOLS}/clean_pdb.py complex_${comp_index}.pdb AB   #clean complex
                         mv complex_${comp_index}_AB.pdb complex_${comp_index}.pdb
                         rm *fasta complex.pdb 

                         #fasta_file=${vini_dir}/ligands/fasta_files/${drug}.fasta #clean ligand
                         #chains=`grep -c ">" ${fasta_file}`     
                         #if  [ $chains -eq $ONES ]
                         #then
                         #    chains=A
                         #else
                         #    chains=AB
                         #fi
                         #python ${ROSETTA_TOOLS}/clean_pdb.py ligand_${lig_index}.pdb ${chains} 
                         #mv ligand_${lig_index}_${chains}.pdb ligand_${lig_index}.pdb

                         echo "#!/bin/bash"                                        > dock #relax receptor and ligand
                         echo "#SBATCH --time=$walltime"                          >> dock
                         echo "#SBATCH --account=$SLURMACCT"                      >> dock
                         echo "#SBATCH --partition=$partition"                    >> dock
                         echo "#SBATCH --nodes=1"                                 >> dock
                         echo "#SBATCH --ntasks=1"                                >> dock
                         echo "#SBATCH --cpus-per-task=48"                        >> dock
                         echo "#SBATCH --job-name=Rozy_${M}_${N}"                 >> dock
                         echo "#SBATCH --output=${target_dir}/Rozy_${M}_${N}.out" >> dock
                         echo "#SBATCH --error=${target_dir}/Rozy_${M}_${N}.err"  >> dock
                         echo "relax.cxx11thread.linuxgccrelease -in:file:s complex_${comp_index}.pdb -multithreading:total_threads 48 @flag_input_relax"                                                            >> dock
                         echo "docking_protocol.cxx11thread.linuxgccrelease -in:file:s complex_${comp_index}_0002.pdb -multithreading:total_threads 48 @flag_global_docking"                                         >> dock
                         echo "cp complex_${comp_index}_0002_0001.pdb $target_dir/complex_${comp_index}.pdb" >> dock
                         #echo "cp score.sc  $target_dir/score.sc_${log_index}"   >> dock 
                         echo "grep complex_${comp_index}_0002_0001 score.sc | awk '{print $2}' > $target_dir/log_${log_index}" >> dock
                         chmod u+x                                                   dock                                         
                         ${job_submit}                                               dock
                         echo "brakepoint!" ; sleep 1000
                     fi
                     sh $vini_dir/write_checkpoint ${ligand_number} ${I} ${J} ${L} ${M}    #write restart point
    	         done # end of 5th loop
                 
                 cd $WORKDIR

                 sh $vini_dir/wait_until_jobs_finish

                 #echo "Creating binding energy vector, please wait."
                 #rm -f ${target_dir}/vec*
                 #echo "#!/bin/bash"                                          > ${target_dir}/vec_${lig_index}
                 #echo "#SBATCH --time="$walltime                            >> ${target_dir}/vec_${lig_index}
                 #echo "#SBATCH --cpus-per-task=1"                           >> ${target_dir}/vec_${lig_index}
                 #echo "#SBATCH --mem=4gb"                                   >> ${target_dir}/vec_${lig_index}
                 #echo "#SBATCH --partition="$partition                      >> ${target_dir}/vec_${lig_index}
                 #echo "#SBATCH --job-name=vec_${lig_index}"                 >> ${target_dir}/vec_${lig_index}
                 #echo "#SBATCH --account=$SLURMACCT"                        >> ${target_dir}/vec_${lig_index}
                 #echo "#SBATCH --output=${target_dir}/vec_${lig_index}.out" >> ${target_dir}/vec_${lig_index}
                 #echo "#SBATCH --output=${target_dir}/vec_${lig_index}.err" >> ${target_dir}/vec_${lig_index}
                 #echo "#SBATCH --exclude=${excluded_nodes}"                 >> ${target_dir}/vec_${lig_index} 
                 #cat $vini_dir/create_vector                                >> ${target_dir}/vec_${lig_index}
                 #chmod u+x ${target_dir}/vec_${lig_index}
                 #${job_submit} ${target_dir}/vec_${lig_index} ${target_dir} ${WORKDIR}
                 #sh $vini_dir/wait_until_jobs_finish
                 

                 echo "Creating binding energy matrix, please wait."
                 echo ${target_dir} > target_dir
                 echo "#!/bin/bash"                                          > ${target_dir}/mat_${lig_index}
                 echo "#SBATCH --time="$walltime                            >> ${target_dir}/mat_${lig_index}
                 echo "#SBATCH --cpus-per-task=1"                           >> ${target_dir}/mat_${lig_index}
                 echo "#SBATCH --mem=4gb"                                   >> ${target_dir}/mat_${lig_index}
                 echo "#SBATCH --partition="$partition                      >> ${target_dir}/mat_${lig_index}
                 echo "#SBATCH --job-name=mat_${lig_index}"                 >> ${target_dir}/mat_${lig_index}
                 echo "#SBATCH --account=$SLURMACCT"                        >> ${target_dir}/mat_${lig_index}
                 echo "#SBATCH --output=${target_dir}/mat_${lig_index}.out" >> ${target_dir}/mat_${lig_index}
                 echo "#SBATCH --error=${target_dir}/mat_${lig_index}.err"  >> ${target_dir}/mat_${lig_index}
                 echo "#SBATCH --exclude=${excluded_nodes}"                 >> ${target_dir}/mat_${lig_index} 
                 echo "WORKDIR=${WORKDIR}"                                  >> ${target_dir}/mat_${lig_index}
                 echo "source $INSTALL/miniconda3/bin/activate"             >> ${target_dir}/mat_${lig_index}
                 echo "conda activate env310"                               >> ${target_dir}/mat_${lig_index}
                 echo "python3 $vini_dir/create_energy_binding_matrix.py"   >> ${target_dir}/mat_${lig_index}
                 echo "conda deactivate"                                    >> ${target_dir}/mat_${lig_index}
                 chmod u+x ${target_dir}/mat_${lig_index}
                 ${job_submit} ${target_dir}/mat_${lig_index}
                 sh $vini_dir/wait_until_jobs_finish

                 echo "Calculating eigenvalues, please wait."
                 echo ${target_dir} > target_dir
                 echo "#!/bin/bash"                                            > ${target_dir}/eigen_${lig_index}
                 echo "#SBATCH --time="$walltime                              >> ${target_dir}/eigen_${lig_index}
                 echo "#SBATCH --cpus-per-task=1"                             >> ${target_dir}/eigen_${lig_index}
                 echo "#SBATCH --mem=4gb"                                     >> ${target_dir}/eigen_${lig_index}
                 echo "#SBATCH --partition="$partition                        >> ${target_dir}/eigen_${lig_index}
                 echo "#SBATCH --job-name=eigen_${lig_index}"                 >> ${target_dir}/eigen_${lig_index}
                 echo "#SBATCH --account=$SLURMACCT"                          >> ${target_dir}/eigen_${lig_index}
                 echo "#SBATCH --output=${target_dir}/eigen_${lig_index}.out" >> ${target_dir}/eigen_${lig_index}
                 echo "#SBATCH --error=${target_dir}/eigen_${lig_index}.err"  >> ${target_dir}/eigen_${lig_index}
                 echo "#SBATCH --exclude=${excluded_nodes}"                   >> ${target_dir}/eigen_${lig_index} 
                 echo "WORKDIR=${WORKDIR}"                                    >> ${target_dir}/eigen_${lig_index}
                 echo "source $INSTALL/miniconda3/bin/activate"               >> ${target_dir}/eigen_${lig_index}
                 echo "conda activate env310"                                 >> ${target_dir}/eigen_${lig_index}
                 echo "python3 $vini_dir/compute_eigenvalues.py -s $target_dir/EB_matrix -t $target_dir/E_Vina" >> ${target_dir}/eigen_${lig_index}
                 echo "conda deactivate"                                      >> ${target_dir}/eigen_${lig_index}
                 chmod u+x ${target_dir}/eigen_${lig_index}
                 ${job_submit} ${target_dir}/eigen_${lig_index}
                 sh $vini_dir/wait_until_jobs_finish

                 echo "Calculating SLEM, please wait."
                 echo "#!/bin/bash"                                           > ${target_dir}/select_${lig_index}
                 echo "#SBATCH --time="$walltime                             >> ${target_dir}/select_${lig_index}
                 echo "#SBATCH --cpus-per-task=1"                            >> ${target_dir}/select_${lig_index}
                 echo "#SBATCH --mem=4gb"                                    >> ${target_dir}/select_${lig_index}
                 echo "#SBATCH --partition="$partition                       >> ${target_dir}/select_${lig_index}
                 echo "#SBATCH --job-name=SLEM_${lig_index}"                 >> ${target_dir}/select_${lig_index}
                 echo "#SBATCH --account=$SLURMACCT"                         >> ${target_dir}/select_${lig_index}
                 echo "#SBATCH --output=${target_dir}/SLEM_${lig_index}.out" >> ${target_dir}/select_${lig_index}
                 echo "#SBATCH --error=${target_dir}/SLEM_${lig_index}.err"  >> ${target_dir}/select_${lig_index}
                 echo "#SBATCH --exclude=${excluded_nodes}"                  >> ${target_dir}/select_${lig_index} 
                 echo "WORKDIR=${WORKDIR}"                                   >> ${target_dir}/select_${lig_index}
                 cat $vini_dir/select_SLEM_value                             >> ${target_dir}/select_${lig_index}
                 chmod u+x ${target_dir}/select_${lig_index}
                 ${job_submit} ${target_dir}/select_${lig_index} ${M} ${L} ${J} ${I} ${target_dir} 
                 sh $vini_dir/wait_until_jobs_finish

                 let ligand_number++
             done   #end of 4thloop
         done       #end of 3rd loop
    done            #end of 2nd loop
done                #end of 1st loop

sh $vini_dir/wait_until_jobs_finish

if  [ $cosmic == y ] ; then
    exp=exp
else
    exp=noexp
fi

cp $WORKDIR/SLEM_values $WORKDIR/${CANCER_PATHWAY}_results/SLEM_values_${cell_line}_thl${therapy_level}_${exp}

echo "Deleting equal SLEM entries with equal indices, please wait..."
echo "#!/bin/bash"                                    > $WORKDIR/postproc
echo "#SBATCH --time="$walltime                      >> $WORKDIR/postproc
echo "#SBATCH --cpus-per-task=1"                     >> $WORKDIR/postproc
echo "#SBATCH --mem=4gb"                             >> $WORKDIR/postproc
echo "#SBATCH --partition="$partition                >> $WORKDIR/postproc
echo "#SBATCH --job-name=SLEM_${lig_index}"          >> $WORKDIR/postproc
echo "#SBATCH --account=$SLURMACCT"                  >> $WORKDIR/postproc
echo "#SBATCH --output=$WORKDIR/postproc1.out"       >> $WORKDIR/postproc
echo "#SBATCH --error=$WORKDIR/postproc1.err"        >> $WORKDIR/postproc
echo "#SBATCH --exclude=${excluded_nodes}"           >> $WORKDIR/postproc
echo "WORKDIR=${WORKDIR}"                            >> $WORKDIR/postproc
cat $vini_dir/delete_SLEM_entries_with_equal_indices >> $WORKDIR/postproc  
chmod u+x $WORKDIR/postproc
$job_submit $WORKDIR/postproc
sh $vini_dir/wait_until_jobs_finish

echo "Creating SLEM named lists, please wait."
echo "#!/bin/bash"                                    > $WORKDIR/postproc
echo "#SBATCH --time="$walltime                      >> $WORKDIR/postproc
echo "#SBATCH --cpus-per-task=1"                     >> $WORKDIR/postproc
echo "#SBATCH --mem=4gb"                             >> $WORKDIR/postproc
echo "#SBATCH --partition="$partition                >> $WORKDIR/postproc
echo "#SBATCH --job-name=SLEM_${lig_index}"          >> $WORKDIR/postproc
echo "#SBATCH --account=$SLURMACCT"                  >> $WORKDIR/postproc
echo "#SBATCH --output=$WORKDIR/postproc2.out"       >> $WORKDIR/postproc
echo "#SBATCH --error=$WORKDIR/postproc2.err"        >> $WORKDIR/postproc
echo "#SBATCH --exclude=${excluded_nodes}"           >> $WORKDIR/postproc 
echo "WORKDIR=${WORKDIR}"                            >> $WORKDIR/postproc
cat $vini_dir/create_SLEM_named_list                 >> $WORKDIR/postproc
chmod u+x $WORKDIR/postproc
$job_submit $WORKDIR/postproc
sh $vini_dir/wait_until_jobs_finish

if [ $therapy_level -ne $ONES ] ; then  
   echo "Creating SLEM wings list, please wait."
   echo "#!/bin/bash"                                 > $WORKDIR/postproc
   echo "#SBATCH --time="$walltime                   >> $WORKDIR/postproc
   echo "#SBATCH --cpus-per-task=1"                  >> $WORKDIR/postproc
   echo "#SBATCH --mem=4gb"                          >> $WORKDIR/postproc
   echo "#SBATCH --partition="$partition             >> $WORKDIR/postproc
   echo "#SBATCH --job-name=SLEM_${lig_index}"       >> $WORKDIR/postproc
   echo "#SBATCH --account=$SLURMACCT"               >> $WORKDIR/postproc
   echo "#SBATCH --output=$WORKDIR/postproc3.out"    >> $WORKDIR/postproc
   echo "#SBATCH --error=$WORKDIR/postproc3.err"     >> $WORKDIR/postproc
   cat $vini_dir/create_SLEM_wings_list              >> $WORKDIR/postproc
   echo "#SBATCH --exclude=${excluded_nodes}"        >> $WORKDIR/postproc 
   echo "WORKDIR=${WORKDIR}"                         >> $WORKDIR/postproc
   chmod u+x postproc
   $job_submit $WORKDIR/postproc
   sh $vini_dir/wait_until_jobs_finish

   echo "Creating SLEM wings named list, please wait."
   echo "#!/bin/bash"                                 > $WORKDIR/postproc
   echo "#SBATCH --time="$walltime                   >> $WORKDIR/postproc
   echo "#SBATCH --cpus-per-task=1"                  >> $WORKDIR/postproc
   echo "#SBATCH --mem=4gb"                          >> $WORKDIR/postproc
   echo "#SBATCH --partition="$partition             >> $WORKDIR/postproc
   echo "#SBATCH --job-name=SLEM_${lig_index}"       >> $WORKDIR/postproc
   echo "#SBATCH --account=$SLURMACCT"               >> $WORKDIR/postproc
   echo "#SBATCH --output=$WORKDIR/postproc4.out"    >> $WORKDIR/postproc
   echo "#SBATCH --error=$WORKDIR/postproc4.err"     >> $WORKDIR/postproc
   cat $vini_dir/create_SLEM_wings_named_list        >> $WORKDIR/postproc
   echo "#SBATCH --exclude=${excluded_nodes}"        >> $WORKDIR/postproc 
   echo "WORKDIR=${WORKDIR}"                         >> $WORKDIR/postproc
   chmod u+x postproc
   $job_submit $WORKDIR/postproc
   sh $vini_dir/wait_until_jobs_finish
fi

echo "Done. The results are in $WORKDIR/${CANCER_PATHWAY}_results directory."
