> $WORKDIR/failed_drug_predicted_structures
> $WORKDIR/failed_gene_predicted_structures

while read -r line
do
    protein=`echo $line | awk -F',' '{print $1}'`
    type=`echo $line | awk -F','    '{print $2}'`
    if  [ $type == P ]
    then
        if  [ -e $WORKDIR/${protein}/ranked_0.pdb ]
        then                                                      #prediction succeeded
            cp $WORKDIR/${protein}/ranked_0.pdb ${vini_dir}/database/ligands/pdb_files/${protein}.pdb
        else                                                      #prediction failed
            echo ${protein} >> $WORKDIR/failed_drug_predicted_structures
        fi
    fi
done < $vini_dir/database/ligands/ligands_list

> tmp                     #update receptors_contracted file and copy predicted structures to repo
while read -r line
do
    KEGG_entry_id=`echo $line  | awk '{print $1}'`
    KEGG_gene_name=`echo $line | awk '{print $2}'`
    uniprot_id=`echo $line     | awk '{print $3}'`
    stat=`echo $line           | awk '{print $4}'`
    if  [ $stat != W ]
    then
        echo $line >> tmp
    else
        if  [ -e $WORKDIR/${uniprot_id}/ranked_0.pdb ]
        then                                                     #prediction succeeded
            stat=P
            cp $WORKDIR/${uniprot_id}/ranked_0.pdb $vini_dir/database/genes/pdb_files/${uniprot_id}.pdb
        else                                                     #prediction failed
            stat=F
            echo $uniprot_id >> $WORKDIR/failed_gene_predicted_structures
        fi
        echo ${KEGG_entry_id} ${KEGG_gene_name} ${uniprot_id} ${stat} >> tmp
    fi
done < $WORKDIR/receptors_contracted
mv tmp $WORKDIR/receptors_contracted
